import{v as F,f as R,H as S,M as y,R as C,a7 as V,V as I,a8 as U,L as x,a9 as b,aa as k,ab as j,Y as A,j as E,Z as M,ac as P,ad as T,r as c,o,c as v,w as l,l as g,a as u,d as m,q as B,b as h,k as a,n as p,t as w,F as $,J as z,K as N,_ as q}from"./index.ef40ff0d.js";import{v as J}from"./index.f7dea7a9.js";const _="fileList",G={names:"",ids:-1},Z={names:k,ids:-1};var H={name:"vaxFiles",components:{vaxView:F,vaxForm:R,vaxBox:S,vaxCombobox:y,vaxFileInput:J,vaxButton:C},data(){return{afterPut:()=>this.getJsonData(_),afterDelete:()=>this.getJsonData(_),deleteCaption:"\uF014\xA0\xA0Usu\u0144"}},computed:{...V({ctx:"currentContext",ctxs:"possibleContexts"})},methods:{submitPutEx(e){e.target.elements.file.files.length>0?this.submitPut(e):alert(I),this.reset(e)},getDownloadLink(e){return U+"?mode=file&filename="+encodeURIComponent(e)},getLowerUserRoles(){const e=x.getters.accessLevel,s=b.slice(0,e).reverse();return e>=5?[k,...s]:s},getLowerUserRolesIds(){const e=x.getters.accessLevel,s=j.slice(0,e).reverse();return e>=5?[-1,...s]:s},fctxs(e,s){const t=x.getters.accessLevel;var n=this.ctxs&&this.ctxs[s]&&this.ctxs[s][e]?this.ctxs[s][e]:[];return t>=5?[Z[s],...n.filter(d=>d!==G[s])]:n},aclString(e){if(!e)return"";var s=e.accessControl;if(!s)return"";var t=[];if(s.requiredRole){var n=b[A[s.requiredRole]];n!==void 0&&t.push(n)}for(var d in s.context)t.push(s.context[d].name);return t.length===0?"":"["+t.join(", ")+"]"}},mixins:[E,M(_),P,T]};const r=e=>(z("data-v-a02eac1a"),e=e(),N(),e),K={key:0,class:"vax-flex"},W=p(" Dost\u0119pne pliki "),Y=p(" Zarz\u0105dzane pliki "),O=p(" Wszystkie pliki "),Q=r(()=>a("div",{class:"vax-margin-bottom"},"Dost\u0119pne pliki:",-1)),X=r(()=>a("hr",null,null,-1)),ee={class:"vax-margin-bottom vax-flex-center-vertical"},se=r(()=>a("input",{type:"hidden",name:"mode",value:"file"},null,-1)),te=["value"],ae=["href"],ne=r(()=>a("i",{class:"fa fa-file-o vax-margin-right"},null,-1)),ie=r(()=>a("br",null,null,-1)),oe=r(()=>a("div",{class:"vax-bold vax-margin-bottom"},"Dodaj plik:",-1)),le=r(()=>a("div",{class:"vax-bold vax-margin-bottom"},"Dost\u0119pny dla:",-1));function re(e,s){const t=c("vax-button"),n=c("vax-form"),d=c("vax-box"),L=c("vax-file-input"),f=c("vax-combobox"),D=c("vax-view");return e.jsonView?(o(),v(D,{key:0,"view-data":e.jsonView,response:e.response,"response-class":e.responseClass,class:"vax-width-limit-medium"},{default:l(()=>[e.jsonView.canAccessFilesManaged?(o(),g("div",K,[u(t,{class:"vax-margin-right","button-class":"",onClick:s[0]||(s[0]=i=>e.$router.push("/files"))},{default:l(()=>[W]),_:1}),u(t,{class:"vax-margin-right","button-class":"is-info",onClick:s[1]||(s[1]=i=>e.$router.push("/filesManaged"))},{default:l(()=>[Y]),_:1}),e.jsonView.canAccessFilesAll?(o(),v(t,{key:0,class:"vax-margin-right","button-class":"is-info",onClick:s[2]||(s[2]=i=>e.$router.push("/filesAll"))},{default:l(()=>[O]),_:1})):m("",!0)])):m("",!0),e.fileList?(o(),v(d,{key:1,size:"large"},{default:l(()=>[Q,X,(o(!0),g($,null,B(e.fileList.files,i=>(o(),g("div",ee,[i.canDeleteFile?(o(),v(n,{key:0,name:"deleteFile",class:"vax-inline vax-inline-flex-center-vertical vax-margin-right-medium","submit-button-class":"is-danger vax-fa","submit-caption":e.deleteCaption,"submit-button-margins":!1,action:e.deleteUrl,method:"DELETE",onSubmit:h(e.submitDelete,["prevent"])},{default:l(()=>[se,a("input",{type:"hidden",name:"filename",value:i.name},null,8,te)]),_:2},1032,["submit-caption","action","onSubmit"])):m("",!0),a("a",{href:e.getDownloadLink(i.name)},[ne,p(w(i.name),1),ie,p(w(e.aclString(i.meta)),1)],8,ae)]))),256))]),_:1})):m("",!0),e.jsonView.canPutFile?(o(),v(n,{key:2,name:"putFile",action:e.putUrl,enctype:"multipart/form-data",method:"PUT",onSubmit:h(e.submitPutEx,["prevent"]),"submit-button-margins":!1,class:"vax-margin-left-medium vax-margin-right-medium vax-margin-bottom"},{default:l(()=>[oe,u(L,{class:"has-name is-boxed",ref:"fileUpload"},null,512),le,u(f,{class:"vax-margin-bottom",name:"userRoleRestriction",captions:e.getLowerUserRoles(),values:e.getLowerUserRolesIds()},null,8,["captions","values"]),u(f,{class:"vax-margin-bottom",name:"campaignRestriction",captions:e.fctxs("campaign","names"),values:e.fctxs("campaign","ids")},null,8,["captions","values"]),u(f,{class:"vax-margin-bottom-wide",name:"cityRestriction",captions:e.fctxs("city","names"),values:e.fctxs("city","ids")},null,8,["captions","values"])]),_:1},8,["action","onSubmit"])):m("",!0)]),_:1},8,["view-data","response","response-class"])):m("",!0)}var me=q(H,[["render",re],["__scopeId","data-v-a02eac1a"]]);export{me as default};
